---
export const prerender = true;

import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const viewers = await getCollection("Viewers");

  return viewers.map((viewer) => ({
    params: { id: viewer.id },
    props: { viewer: viewer.data },
  }));
}
const { viewer } = Astro.props;
const { id } = Astro.params;
---

<Layout title={viewer.name}>
  <div
    class="container mx-auto p-6 text-white bg-gray-900 rounded-lg shadow-lg"
  >
    <h1 class="text-4xl font-bold mb-4">{viewer.name}</h1>
    <p class="text-lg mb-6">ID: {viewer.id}</p>

    <h2 class="text-2xl font-semibold mb-4">Movies Watched</h2>
    <ul class="list-disc list-inside space-y-4">
      {
        viewer.ratings.map((rating) => (
          <div class="p-4 bg-slate-800 rounded-lg hover:bg-slate-700 transition-colors duration-300">
            <div class="flex justify-between items-center">
              <a href={`/movies/${rating.movieId}`} class="underline text-lg">
                {rating.movieTitle}
              </a>
              <a
                href={`/viewers/${id}/ratings/${rating.id}`}
                class="underline text-sm text-gray-400"
              >
                Rating: {rating.score}
              </a>
            </div>
          </div>
        ))
      }
    </ul>
  </div>
</Layout>
